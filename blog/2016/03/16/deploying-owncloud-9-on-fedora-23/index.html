<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="generator" content="Hugo 0.93.3" />

  <title>Deploying ownCloud 9 on Fedora 23 &middot; Calgary RHCE</title>

  <meta name="description" content="" />

  
  <meta property="og:locale" content="en-us"/>

  
  <meta property="og:image" content="https://calgaryrhce.ca/wp-content/uploads/2016/08/cropped-1477782_10152102853181489_71278912_n.jpg">

  
  <meta property="og:site_name" content="Calgary RHCE"/>
  <meta property="og:title" content="Deploying ownCloud 9 on Fedora 23"/>
  <meta property="og:description" content="I’ve been playing around with server/VM provisioning lately and have come across a need to store some basic deployment files in the cloud. For me, these are things like ansible code, a home directory .tar file, among a few other personal items. With ownCloud 9 being recently released, I thought I should give it a try."/>
  <meta property="og:url" content="https://calgaryrhce.ca/blog/2016/03/16/deploying-owncloud-9-on-fedora-23/"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2016-03-16T23:14:21Z"/>
  <meta property="article:modified_time" content="2016-03-16T23:14:21Z"/>
  <meta property="article:author" content="Andrew Ludwar">
  
  
  

  <script type="application/ld+json">
  {
    "@context" : "http://schema.org",
    "@type" : "Blog",
    "name": "Calgary RHCE",
    "url" : "https://calgaryrhce.ca/",
    "image": "https://calgaryrhce.ca/wp-content/uploads/2016/08/cropped-1477782_10152102853181489_71278912_n.jpg",
    "description": "A linux and open source technology blog."
  }
  </script>

  
  <script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "name": "Deploying ownCloud 9 on Fedora 23",
    "headline": "Deploying ownCloud 9 on Fedora 23",
    "datePublished": "2016-03-16T23:14:21Z",
    "dateModified": "2016-03-16T23:14:21Z",
    "author": {
      "@type": "Person",
      "name": "Andrew Ludwar",
      "url": "https://calgaryrhce.ca/"
    },
    "image": "https://calgaryrhce.ca/wp-content/uploads/2016/08/cropped-1477782_10152102853181489_71278912_n.jpg",
    "url": "https://calgaryrhce.ca/blog/2016/03/16/deploying-owncloud-9-on-fedora-23/",
    "description": "I’ve been playing around with server\/VM provisioning lately and have come across a need to store some basic deployment files in the cloud. For me, these are things like ansible code, a home directory .tar file, among a few other personal items. With ownCloud 9 being recently released, I thought I should give it a try."
  }
  </script>
  


  <link type="text/css"
        rel="stylesheet"
        href="https://calgaryrhce.ca/css/print.css"
        media="print">

  <link type="text/css"
        rel="stylesheet"
        href="https://calgaryrhce.ca/css/poole.css">

  <link type="text/css"
        rel="stylesheet"
        href="https://calgaryrhce.ca/css/hyde.css">

  
<style type="text/css">
  .sidebar {
    background-color: #990000;
  }

  .read-more-link a {
    border-color: #990000;
  }

  footer a,
  .content a,
  .related-posts li a:hover {
    color: #990000;
  }
</style>



  

  <link rel="stylesheet"
        href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700&display=swap">

  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css"
        integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk="
        crossorigin="anonymous" />

  <link rel="apple-touch-icon-precomposed"
        sizes="144x144"
        href="/apple-touch-icon-144-precomposed.png">

  <link rel="shortcut icon" href="/favicon.png">

  
  </head>
<body>
  <aside class="sidebar">
  <div class="container">
    <div class="sidebar-about">
      
        
        <div class="author-image">
          <img src="https://calgaryrhce.ca/wp-content/uploads/2016/08/cropped-1477782_10152102853181489_71278912_n.jpg" class="img-circle img-headshot center" alt="Profile Picture">
        </div>
        
      

      <h1>Calgary RHCE</h1>

      
      <p class="lead">A linux and open source technology blog.</p>
      
    </div>

    <nav>
      <ul class="sidebar-nav">
        <li>
          <a href="https://calgaryrhce.ca/">Home</a>
        </li>
        <li>
          <a href="/posts/"> Posts </a>
        </li><li>
          <a href="/about/"> About </a>
        </li>
      </ul>
    </nav>

    <section class="social-icons">
      
      <a href="https://ca.linkedin.com/in/andrewludwar" rel="me" title="Linkedin">
        <i class="fab fa-linkedin" aria-hidden="true"></i>
      </a>
      
      <a href="https://github.com/aludwar" rel="me" title="GitHub">
        <i class="fab fa-github" aria-hidden="true"></i>
      </a>
      
      <a href="https://twitter.com/andrewludwar" rel="me" title="Twitter">
        <i class="fab fa-twitter" aria-hidden="true"></i>
      </a>
      
    </section>
  </div>
</aside>


  <main class="content container">
  <div class="post">
  <h1>Deploying ownCloud 9 on Fedora 23</h1>

  <div class="post-date">
    <time datetime="2016-03-16T23:14:21Z">Mar 16, 2016</time> · 5 min read
  </div>

  <p>I’ve been playing around with server/VM provisioning lately and have come across a need to store some basic deployment files in the cloud. For me, these are things like ansible code, a home directory .tar file, among a few other personal items. With ownCloud 9 being recently released, I thought I should give it a try. Digging further into its features I see that ownCloud can federate many external cloud storage solutions (Dropbox, GoogleDrive, etc.) – cool! Another useful feature is that ownCloud can enable encryption on any personal data in addition to the encryption methods used by Dropbox and Google. This will provide an additional layer of encryption in case that Dropbox or Google’s data is compromised and decrypted, my data will still be protected by my own encryption keys. That adds a nice layer of safety for my personal data, so lets do a deployment and connect ownCloud to GoogleDrive to start.</p>
<p>The first thing I started with was a fresh install of Fedora 23 server. (I originally tried CentOS but ran into some out-of-date package issues with nss). With ownCloud 9 being so new, it’s not yet included in Fedora’s standard repos, so I did an install from source. You can download the source from <a href="https://owncloud.org/install/">owncloud.org</a>, verify with MD5/SHA256 and/or GPG, and continue with my steps below. I used the following two links to help with my install. <a href="https://doc.owncloud.org/server/9.0/admin_manual/installation/source_installation.html">Manual installation of ownCloud</a>, and <a href="https://doc.owncloud.org/server/9.0/admin_manual/installation/command_line_installation.html">ownCloud installation from the command line</a>. Firstly, ownCloud uses a web and database server on the back end. You’re free to chose your own flavours of each, for me I chose apache and mysql(mariadb). When installing from source, you’ll need to manually install your web and database server prior to ownCloud:</p>
<!-- raw HTML omitted -->
<p>Also, there’s a whack of PHP modules you’ll need. I cheekily grabbed a list of these from the Fedora packaged ownCloud 8 installation – it parses all the dependencies for you. I issued a dnf install owncloud command to get all the PHP dependencies, then awk’d them out of the output. I put them in a file, and installed with a for loop:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>That should take care of the prerequisites (you can compared with ownCloud’s docs, and php -m | grep ‘module’ if you like). Then I enabled and started each service:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>For additional security, I’ll install SSL capability on the web server. First by installing mod_ssl, then generating a self-signed SSL certificate, and adding it to the apache config:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>Also, it’s a good idea to run the secure installation/setup of mysql(mariadb), which you can do by running this utility and following the prompts:</p>
<!-- raw HTML omitted -->
<p>Ok! Now after a quick check of everything working, we’re ready to start installing ownCloud. To start we’ll untar the files into the default web directory, and add the owncloud config into apache:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>Then we’ll need to make some SELinux permission changes. I highly recommend you DO NOT disable SELinux. Depending on your setup, there may be <a href="https://doc.owncloud.org/server/9.0/admin_manual/installation/selinux_configuration.html">additional SELinux changes</a> you’ll need to make.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>My data directory is on an NFS share from another computer, so I need to make an additional SELinux change:</p>
<!-- raw HTML omitted -->
<p>Now, onto the database initialization. The below install command is right out of ownCloud’s docs, make sure your default web directory is owned by the httpd daemon user, and run the install command:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>Now you should be able to browse to <em>https://localhost/owncloud</em> to login! Depending on if you’re accessing the owncloud host locally or from another server, you may need to add the domain to the trusted domains list in <em>/var/www/html/owncloud/config/config.php</em>. The web GUI should alert and prompt you to do that, but if not, you can modify the file directly. Here’s my config.php file with the password data omitted:</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>Once in the GUI, you can enable encryption from the admin menu at the far right. Server side encryption can be enabled with a checkbox. It’s also good to enter a recovery key in the event you need to recover your encrypted data:<!-- raw HTML omitted --></p>
<p><a href="https://calgaryrhce.ca/wp-content/uploads/2016/03/owncloud-encrypt1.png"><!-- raw HTML omitted --></a><!-- raw HTML omitted -->ownCloud encryption configuration<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p>Then you need to install  the default encryption app. First at the top left, switch from files to apps, then click on not enabled, and find and enable the default encryption module. You may need to logout and back in again for the keys to initialize.<!-- raw HTML omitted --></p>
<p><a href="https://calgaryrhce.ca/wp-content/uploads/2016/03/owncloud-encrypt.png"><!-- raw HTML omitted --></a><!-- raw HTML omitted -->ownCloud encrypt application<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p>Now, to add external storage from Google Drive, you’ll need to enable API access and create OAuth2 credentials in your Google account. You can do this by visiting <a href="https://console.developers.google.com/apis/credentials">https://console.developers.google.com/apis/credentials</a>, and creating a project, then creating OAuth2 credentials within that project. This will give you a ClientID and Client Secret to enter into ownCloud. ownCloud will access your Google Drive data via Google’s API. Here’s what mine looks like, and I also needed to add my domain and a redirect URI for Google to redirect the user (web browser) after authenticating:</p>
<p><a href="https://calgaryrhce.ca/wp-content/uploads/2016/03/google-dev-console.png"><!-- raw HTML omitted --></a></p>
<p>Google Dev Console<!-- raw HTML omitted --></p>
<p><a href="https://calgaryrhce.ca/wp-content/uploads/2016/03/google-dev-console-2.png"><!-- raw HTML omitted --></a><!-- raw HTML omitted -->Google Dev Console<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p>In the admin section again, you can enter those Client ID and secret details, add the user you’re giving access to the storage, and click grant access:<!-- raw HTML omitted --></p>
<p><a href="https://calgaryrhce.ca/wp-content/uploads/2016/03/owncloud-extstorage.png"><!-- raw HTML omitted --></a><!-- raw HTML omitted -->ownCloud external storage<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p>Now login as that user, and your Google Drive files will be available!<!-- raw HTML omitted --></p>
<p><a href="https://calgaryrhce.ca/wp-content/uploads/2016/03/owncloud-extstorage2.png"><!-- raw HTML omitted --></a><!-- raw HTML omitted -->ownCloud Google Drive<!-- raw HTML omitted --><!-- raw HTML omitted --> <!-- raw HTML omitted --><a href="https://calgaryrhce.ca/wp-content/uploads/2016/03/owncloud-extstorage3.png"><!-- raw HTML omitted --></a><!-- raw HTML omitted -->ownCloud Google Drive<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p>This ended up being relatively long, so I’ll cover further work in an additional post. 🙂</p>

</div>


  </main>

  <footer>
  <div class="copyright">
    &copy;  2022 · 
  </div>
</footer>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/js/all.min.js"
          integrity="sha256-MAgcygDRahs+F/Nk5Vz387whB4kSK9NXlDN3w58LLq0="
          crossorigin="anonymous"></script>

  

  
</body>
</html>
